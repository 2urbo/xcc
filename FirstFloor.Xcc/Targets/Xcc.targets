<!--
***********************************************************************************************
Xcc.targets

WARNING:  DO NOT MODIFY this file unless you are knowledgeable about MSBuild and have
          created a backup copy. 

Copyright (C) First Floor Software. All rights reserved.
***********************************************************************************************
-->

<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <UsingTask TaskName="PreprocessXaml" AssemblyFile="$(MSBuildThisFileDirectory)..\tools\Xcc.dll" />

  <Target Name="GenerateXaml" BeforeTargets="MarkupCompilePass1">
    <!-- preprocess xaml pages -->
    <PreprocessXaml ApplicationDefinitions="@(ApplicationDefinition)"
                    Pages="@(Page)"
                    DefinedSymbols="$(DefineConstants)"
                    OutputPath="$(IntermediateOutputPath)preprocessedxaml\">
      <Output ItemName="OldApplicationDefinition" TaskParameter="OldApplicationDefinitions" />
      <Output ItemName="OldPage" TaskParameter="OldPages" />
      <Output ItemName="NewApplicationDefinition" TaskParameter="NewApplicationDefinitions" />
      <Output ItemName="NewPage" TaskParameter="NewPages" />
      <Output ItemName="FileWrites" TaskParameter="GeneratedFiles" />
    </PreprocessXaml>
    <ItemGroup>
      <ApplicationDefinition Remove="@(OldApplicationDefinition)" />
      <Page Remove="@(OldPage)" />

      <ApplicationDefinition Include="@(NewApplicationDefinition)" />
      <Page Include="@(NewPage)" />
    </ItemGroup>
  </Target>
</Project>